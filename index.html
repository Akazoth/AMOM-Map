<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>AMOM Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { height: 100vh; }
    body { margin: 0; }
    .sticker {
      cursor: pointer;
      transition: transform 0.15s;
    }
    .sticker:hover {
      transform: scale(1.1);
    }
    #breadcrumb {
      position: absolute;
      bottom: 10px;
      left: 10px;
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 6px 12px;
      border-radius: 8px;
      font-family: sans-serif;
      font-size: 14px;
      z-index: 1000;
    }
    .fantasy-popup .leaflet-popup-content-wrapper {
      background: url('ParchmentTexture.jpg') center/cover no-repeat;
      color: #2b1d0e;
      font-family: "IM Fell English", serif;
      font-size: 14px;
      border: 2px solid #000000;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.7);
      padding: 6px;
    }

    .fantasy-popup .leaflet-popup-tip {
      background: #000000;
    }

    .fantasy-popup .popup-card {
      text-align: center;
    }

    .fantasy-popup .popup-card h3 {
      margin: 0;
      font-size: 20px;
      font-weight: bold;
      color: #d4af37; /* gold */
      text-shadow: 1px 1px 2px black;
    }

    .fantasy-popup .popup-card .popup-desc {
      margin-top: 4px;
      font-size: 15px;
      font-weight: normal;
      font-style: italic;
      color: #d4af37;
      text-shadow: 1px 1px 2px black;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <div id="breadcrumb">helos</div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Create the map with minZoom to allow zooming out further
    const map = L.map('map', { 
      crs: L.CRS.Simple, 
      doubleClickZoom: false, 
      minZoom: -1 
    });
    const breadcrumbEl = document.getElementById("breadcrumb");

    // === Map Definitions ===
    const maps = {
      helos: {
        name: "Helos",
        image: "helos_map.png",
        size: [1536, 2048],
        markers: [
          { coords: [58, 130], size: [170, 70], icon: "Miraket_icon.png", name: "Miraket", desc: "The 10 year continent", enter: 		"miraket" },
        ]
      },
      miraket: {
        name: "Miraket",
        image: "Miraket.jpg",
        size: [1536, 2048],
        markers: [
          { coords: [1200, 299], size: [80, 80], icon: "City_placeholder.png", name: "Eisenhold", enter: "eisenhold", },
          { coords: [250, 395], size: [145, 150], icon: "Answell_Icon.png", name: "Answell", enter: "answell" },
          { coords: [1060, 908], size: [100, 110], icon: "Geneva_Icon.png", name: "Geneva", enter: "geneva" },
	  { coords: [60, 120], size: [200, 100], icon: "back_return.png", name: "Go Back", backTo: "helos" }
        ]
      },
      eisenhold: {
        name: "Eisenhold",
        image: "eisenhold.png",
        size: [637, 1120],
        markers: [
          { coords: [400, 400], size: [60, 60], icon: "City_placeholder.png", name: "Eisenhold Streets", enter: "eisenhold_in1" },
          { coords: [50, 50], size: [100, 60], icon: "back_return.png", name: "Go Back", backTo: "miraket" }
        ]
      },
      eisenhold_in1: {
        name: "Eisenhold Streets",
        image: "eisenhold_in1.jpg",
        size: [600, 1000],
        markers: [
          { coords: [450, 200], size: [50, 50], icon: "City_placeholder.png", name: "Pin" },
          { coords: [50, 50], size: [100, 60], icon: "back_return.png", name: "Go Back", backTo: "eisenhold" }
        ]
      },
      geneva: {
        name: "Geneva",
        image: "geneva_map.jpg",
        size: [600, 1000],
        markers: [
          { coords: [400, 400], size: [60, 60], icon: "City_placeholder.png", name: "Geneva Streets", enter: "geneva_in1" },
          { coords: [50, 50], size: [100, 60], icon: "back_return.png", name: "Go Back", backTo: "miraket" }
        ]
      },
      geneva_in1: {
        name: "Dead fokin people",
        image: "geneva_in1.jpg",
        size: [600, 1000],
        markers: [
          { coords: [300, 300], size: [50, 50], icon: "City_placeholder.png", name: "Pin" },
          { coords: [50, 50], size: [100, 60], icon: "back_return.png", name: "Go Back", backTo: "geneva" }
        ]
      },
      answell: {
        name: "Answell",
        image: "answell_map.jpg",
        size: [600, 1000],
        markers: [
          { coords: [450, 450], size: [70, 70], icon: "City_placeholder.png", name: "Answell Streets", enter: "answell_in1" },
          { coords: [50, 50], size: [100, 60], icon: "back_return.png", name: "Go Back", backTo: "miraket" }
        ]
      },
      answell_in1: {
        name: "Answell Streets",
        image: "answell_in1.jpg",
        size: [600, 1000],
        markers: [
          { coords: [300, 300], size: [50, 50], icon: "City_placeholder.png", name: "Pin" },
          { coords: [50, 50], size: [100, 60], icon: "back_return.png", name: "Go Back", backTo: "answell" }
        ]
      }
    };

    let currentLayer = null;
    let path = ["Helos"]; // breadcrumb path

    function updateBreadcrumb() {
      breadcrumbEl.textContent = path.join(" → ");
    }

function loadMap(mapKey) {
  const m = maps[mapKey];
  if (!m) return;

  // remove old background
  if (currentLayer) map.removeLayer(currentLayer);

  const bounds = [[0, 0], [m.size[0], m.size[1]]];
  currentLayer = L.imageOverlay(m.image, bounds).addTo(map);

  // Fit whole map on screen with a little padding
  map.fitBounds(bounds);

  // remove old sticker layers
  map.eachLayer(layer => {
    if (layer._isSticker) map.removeLayer(layer);
  });

  // update breadcrumb trail properly
  if (path[path.length - 1] !== m.name) {
    path.push(m.name);
  }
  updateBreadcrumb();

  // add stickers (scaling images)
  m.markers.forEach(marker => {
    const halfW = marker.size[0] / 2;
    const halfH = marker.size[1] / 2;
    const topLeft = [marker.coords[0] - halfH, marker.coords[1] - halfW];
    const bottomRight = [marker.coords[0] + halfH, marker.coords[1] + halfW];

    const sticker = L.imageOverlay(marker.icon, [topLeft, bottomRight], {
      interactive: true,
      className: "sticker"
    }).addTo(map);

    sticker._isSticker = true;

    // single click → popup
sticker.on("click", (e) => {
  const content = `
    <div class="popup-card">
      <h3>${marker.name}</h3>
      ${marker.desc ? `<div class="popup-desc">${marker.desc}</div>` : ""}
    </div>
  `;
  const popup = L.popup({ className: "fantasy-popup" })
    .setLatLng(e.latlng)
    .setContent(content)
    .openOn(map);
});

    // double click → enter/back
    sticker.on("dblclick", () => {
      map.closePopup();

      if (marker.enter) {
        // entering a new submap → push
        path.push(maps[marker.enter].name);
        loadMap(marker.enter);

      } else if (marker.backTo) {
        // going back → trim path until we reach the right parent
        const targetName = maps[marker.backTo].name;
        const idx = path.indexOf(targetName);
        if (idx !== -1) {
          path = path.slice(0, idx + 1);
        } else {
          // fallback: reset if not found
          path = [maps[marker.backTo].name];
        }
        loadMap(marker.backTo);
      }
    });
  });
}
    // start at world map
    loadMap("helos");
  </script>
</body>
</html>

